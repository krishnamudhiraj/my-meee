{"version":3,"file":"8.4b459a7e504825e2a262.hot-update.js","sources":["webpack:///redux/reducers/schoolData/actions.js","webpack:///services/schools.js"],"sourcesContent":["import { ON_SCHOOL_NAMES_REQUESTED, ON_SCHOOL_NAMES_FETCHED, ON_SCHOOL_DATA_REQUESTED, ON_SCHOOL_DATA_FETCHED } from './types';\nimport { fetchSchools, fetchSchoolDataService } from '../../../services/schools';\n\nexport const fetchSchoolNames = () => async (dispatch, getState) => {\n  dispatch({ type: ON_SCHOOL_NAMES_REQUESTED });\n  const schoolList = await fetchSchools();\n  const schoolArrayList = [];\n  schoolList.forEach(element => {\n    schoolArrayList.push({ label: element });\n  });\n\n  dispatch({ type: ON_SCHOOL_NAMES_FETCHED, schoolList: schoolArrayList });\n};\n\nexport const fetchSchoolData = (schoolname) => async (dispatch, getState) => {\n  dispatch({ type: ON_SCHOOL_DATA_REQUESTED });\n  const schoolData = await fetchSchoolDataService(schoolname);\n  dispatch({ type: ON_SCHOOL_DATA_FETCHED, schoolData });\n};\n\n\n\n// WEBPACK FOOTER //\n// redux/reducers/schoolData/actions.js","import { has, uniq } from 'lodash';\nimport { firebaseApp } from '../config/firebase';\nconst db = firebaseApp.firestore();\n\nexport const updateUserData = (key, data) =>\n  new Promise((resolve, reject) => {\n    db.collection('/schoolsUsers')\n      .doc(key)\n      .update(data)\n      .then(() => {\n        resolve(true);\n      })\n      .catch(err => {\n        reject(err);\n      });\n  });\n\nexport const getCode = () => {\n  const codes = fetchCodes();\n  let flag = true;\n  let randomNumber = null;\n\n  while (flag) {\n    randomNumber = Math.floor(1000 + Math.random() * 9000);\n    if (!has(codes, randomNumber)) {\n      flag = false;\n    }\n  }\n\n  return randomNumber;\n};\n\nexport const fetchCodes = () => {\n  const codes = [];\n\n  db.collection('/schools').get().then(snapshot => {\n    snapshot.forEach(doc => {\n      const data = doc.data();\n      codes.push(data.code);\n    });\n  }).catch(err => {\n    console.log('Error getting codes data: ', err);\n  });\n\n  return codes;\n};\n\nexport const generateSchoolCodes = (data) => new Promise((resolve, reject) => {\n  const code = getCode();\n  const item = {\n    school_name: data.school,\n    code,\n    is_code_used: false,\n    allowed_users: Number(data.numberOfCodes)\n  };\n  db.collection('/schools')\n    .add(item)\n    .catch(err => {\n      reject({ response: false, error: err });\n      console.log('Error while generating codes: ', err);\n    });\n  resolve({ response: true, codes: code });\n});\n\nexport const fetchSchools = () => new Promise((resolve, reject) => {\n  let schools = [];\n\n  db.collection('/schools').get().then(snapshot => {\n    snapshot.forEach(doc => {\n      const data = doc.data();\n      schools.push(data.school_name);\n    });\n    schools = uniq(schools);\n    resolve(schools);\n  }).catch(err => {\n    console.log('Error getting school names: ', err);\n    reject(err);\n  });\n});\n\nexport const fetchSchoolDataService = (schoolname) => new Promise((resolve, reject) => {\n  const schoolData = [];\n  db.collection('/schoolsUsers')\n    .where('school_name', '==', schoolname)\n    .get()\n    .then(snapshot => {\n      snapshot.forEach(doc => {\n        const data = doc.data();\n        schoolData.push(data);\n      });\n      resolve(schoolData);\n    })\n    .catch(err => {\n      console.log('Error getting school data: ', err);\n      reject(err);\n    });\n});\n\n\n\n// WEBPACK FOOTER //\n// services/schools.js"],"mappings":";;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AADA;AAAA;AACA;AADA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AADA;AAAA;AACA;AADA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;ACdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AAAA;AAEA;AAIA;AACA;AAEA;AACA;AACA;AAXA;AAaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AAGA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAfA;AAiBA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AAgBA;AAAA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAhBA;;;;A","sourceRoot":""}